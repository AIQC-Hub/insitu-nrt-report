```{r, message = FALSE, warning = FALSE}

# Common variables
netcdf <- "cmems_obs-ins_bal_phybgcwav_mynrt_na_irr"
netcdf_doi <- "https://doi.org/10.48670/moi-00032"
region <- "Baltic Sea"
region_code1 <- "BO"
region_code2 <- "GL"
parquet <- "netcdf_nrt_bo_gl.parquet"
parquet_url <- file.path(release_url, parquet)
df_name <- "df_bo_gl"

# Path
#rsc_dir <- "../../data/nrt_bo"
#rsc_dir <- "../data/nrt_bo"

# Data frame
bo_file_name <- file.path(rsc_dir, parquet)
if (!exists(df_name)) {
  df_bo_gl <- read_parquet(bo_file_name)
}

# Time spans
time_span1 <- "All"
time_span1_from <- 1959
time_span1_to <- 2025
time_span2 <- "ts5988"
time_span2_from <- 1959
time_span2_to <- 1988
time_span3 <- "ts89A5"
time_span3_from <- 1989
time_span3_to <- 2015
time_span4 <- "tsA6B5"
time_span4_from <- 2016
time_span4_to <- 2025

# Locations
longitude_var_name <- "longitude"
latitude_var_name <- "latitude"

bo_min_lon <- 6
bo_max_lon <- 28
bo_min_lat <- 54
bo_max_lat <-  66

bo_excl_lon_bl <- 6
bo_excl_lat_bl <- 60
bo_excl_lon_tr <- 15
bo_excl_lat_tr <- 66

# Platforms with multiple locations
platform1 <- "UMFF9A13"
platform2 <- "UMFNB1B3"
platform3 <- "SMHIRR7"

# Count variables for observation count density plots
count1_1 <- "100"
count1_2 <- "30"
count1_3 <- "3000"
count2_1 <- "1"
count2_2 <- "1"
count3_1 <- "2"
count3_2 <- "2"
count4_1 <- "3000"
count4_2 <- "3600"
count5 <- "4000"

# Functions
split_time_spans <- function(df) {
  split_time_spans_common(df, time_span1, time_span1_from, time_span1_to,
                          time_span2, time_span2_from, time_span2_to,
                          time_span3, time_span3_from, time_span3_to,
                          time_span4, time_span4_from, time_span4_to)
}

filer_locations <- function(df) {
  filer_locations_common(df, bo_min_lon, bo_max_lon, bo_min_lat, bo_max_lat)
}

exclude_locations <- function(df) {
  exclude_locations_common(bo_excl_lon_bl, bo_excl_lat_bl, bo_excl_lon_tr, bo_excl_lat_tr)
}

get_unique_profile_no <- function(df) {
  get_unique_profile_no_common(df, longitude, latitude)
}

update_profile_no <- function(df, df_profiles) {
  update_profile_no_common(df, df_profiles, longitude, latitude, "longitude", "latitude")
}

find_duplicates_within_platforms <- function(df) {
  find_duplicates_within_platforms_common(df, longitude, latitude)
}

find_duplicates_across_platforms <- function(df) {
  find_duplicates_across_platforms_common(df, longitude, latitude)
}

summarise_df_dup <- function(df_orig, df_dup) {
  summarise_df_dup_common(df_orig, df_dup, longitude, latitude)
}

remove_duplicates_within_platforms <- function(df_orig, df_dup_summary) {
  remove_duplicates_within_platforms_common(df_orig, df_dup_summary)
}

```
